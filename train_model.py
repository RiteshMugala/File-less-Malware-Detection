import pandas as pd
from sklearn.preprocessing import LabelEncoder
from sklearn.ensemble import RandomForestClassifier


# Load the data
train = pd.read_csv('C:/Users/Jatin/Desktop/DetectionDataSet/Train_data2.csv')

# Preprocess categorical columns using label encoding
categorical_cols = ['protocol_type', 'service', 'flag']
label_encoder = LabelEncoder()

for col in categorical_cols:
    train[col] = label_encoder.fit_transform(train[col])

# Split the data into input and output variables
X_train = train.drop(['class'], axis=1)
Y_train = train['class']

# Train your model using the preprocessed data
model = RandomForestClassifier()
model.fit(X_train, Y_train)

# Save the trained model
import pickle

with open('trained_model.pkl', 'wb') as file:
    pickle.dump(model, file)
